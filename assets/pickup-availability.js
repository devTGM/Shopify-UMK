class PickupAvailability extends HTMLElement{constructor(){super(),this.hasAttribute("available")&&(this.errorHtml=this.querySelector("template").content.firstElementChild.cloneNode(!0),this.onClickRefreshList=this.onClickRefreshList.bind(this),this.fetchAvailability(this.dataset.variantId))}fetchAvailability(t){const e=this.dataset.rootUrl.endsWith("/")?this.dataset.rootUrl:`${this.dataset.rootUrl}/`;fetch(`${e}variants/${t}/?section_id=pickup-availability`).then((t=>t.text())).then((t=>{const e=(new DOMParser).parseFromString(t,"text/html").querySelector(".shopify-section");this.renderPreview(e)})).catch((t=>{const e=this.querySelector("button");e&&e.removeEventListener("click",this.onClickRefreshList),this.renderError()}))}onClickRefreshList(t){this.fetchAvailability(this.dataset.variantId)}renderError(){this.innerHTML="",this.appendChild(this.errorHtml),this.querySelector("button").addEventListener("click",this.onClickRefreshList)}renderPreview(t){if(!t.querySelector("pickup-availability-preview"))return this.innerHTML="",void this.removeAttribute("available");this.innerHTML=t.querySelector("pickup-availability-preview").outerHTML,this.setAttribute("available","")}}customElements.define("pickup-availability",PickupAvailability)