class DynamicLoad extends HTMLElement{constructor(){super(),this.itemGrid=document.querySelector("#product-grid")||document.querySelector("#collection-grid")||document.querySelector("#article-grid"),this.itemGrid?("collection-grid"===this.itemGrid.id?this.gridType="collection":"product-grid"===this.itemGrid.id?this.gridType="product":"article-grid"===this.itemGrid.id?this.gridType="article":this.gridType="unknown",this.setProperties()):console.error("Grid element not found.")}setProperties(){}appendContent(e,t=!1){t?this.itemGrid.insertAdjacentHTML("afterbegin",e):this.itemGrid.insertAdjacentHTML("beforeend",e)}updateUrl(e){const t=new URL(window.location.href),r=new URLSearchParams(t.search);1===e?r.delete("page"):r.set("page",e),t.search=r.toString(),history.replaceState({},"",t.toString())}updateItemCount(){let e;switch(this.gridType){case"product":e=".product-card";break;case"collection":e=".card-collection";break;case"article":e=".card-article";break;default:e=".card-item"}const t=this.itemGrid.querySelectorAll(e).length;if("product"!==this.gridType)return;const r=document.querySelector(".collection-facets__product-count .product-count-of-all");r&&(r.innerText=t)}}if(!customElements.get("dynamic-load-more")){class e extends DynamicLoad{constructor(){super(),this.btnLoadMore=this.querySelector(".js-btn-load-more"),this.observer=null,this.isInfinityScrollActive=!1,this.setProperties(),this.toggleItemsVisibility(),window.addEventListener("shopify:section:load",(()=>{this.setProperties(),this.toggleItemsVisibility()})),this.updateItemCount(),this.btnLoadMore.addEventListener("click",(e=>{e.preventDefault(),this.loadMoreItems()})),this.checkAndSetupInfinityScroll()}checkAndSetupInfinityScroll(){if(this.itemGrid){const e="product"===this.gridType?"ProductGridContainer":"collection"===this.gridType?"CollectionGridContainer":"article"===this.gridType?"ArticleGridContainer":null;if(e){const t=this.itemGrid.closest(`#${e}`);console.log("Parent Container:",t,t.classList),t&&t.classList.contains("infinity-scroll-active")?(console.log("Infinity Scroll is active for:",this.gridType),this.isInfinityScrollActive=!0,this.setupInfinityScroll()):this.isInfinityScrollActive=!1}else this.isInfinityScrollActive=!1}else this.isInfinityScrollActive=!1}setupInfinityScroll(){this.btnLoadMore&&(this.observer&&this.observer.disconnect(),this.observer=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&!this.btnLoadMore.hasAttribute("disabled")&&this.btnLoadMore.click()}))}),{root:null,rootMargin:"0px",threshold:.1}),this.observer.observe(this.btnLoadMore))}toggleItemsVisibility(){const e=this.btnLoadMore.dataset.href;this.btnLoadMore.style.display=e?"":"none"}async loadMoreItems(){this.btnLoadMore.setAttribute("disabled","true");const e=this.btnLoadMore.dataset.href;if(e)try{const t=await fetch(e),r=await t.text(),i=(new DOMParser).parseFromString(r,"text/html");let o;"product"===this.gridType?o=i.querySelector("#ProductGridContainer"):"collection"===this.gridType?o=i.querySelector("#CollectionGridContainer"):"article"===this.gridType&&(o=i.querySelector("#ArticleGridContainer"));const s=o?o.querySelector(`#${this.gridType}-grid`):null;if(s?this.appendContent(s.innerHTML):console.warn(`New grid element (#${this.gridType}-grid) not found in fetched page.`),this.btnLoadMore=this.querySelector(".js-btn-load-more"),!this.btnLoadMore)return void console.error("Load More button disappeared after content append. Cannot continue.");const n=i.querySelector(".js-btn-load-more");if(n){const e=n.dataset.href;this.btnLoadMore.dataset.href=e}else this.btnLoadMore.dataset.href="";const a=new URL(window.location.href),d=new URLSearchParams(a.search),c=parseInt(d.get("page"),10)||1;this.updateUrl(c+1),this.updateItemCount(),this.toggleItemsVisibility(),this.isInfinityScrollActive&&this.setupInfinityScroll()}catch(e){console.error("Load more error:",e);const t=document.createElement("div");t.className="error-message p-4 bg-red-100 border border-red-400 text-red-700 rounded-md mt-4",t.textContent=`An error occurred: ${e.message}`,this.btnLoadMore.after(t),setTimeout((()=>t.remove()),5e3)}finally{this.btnLoadMore.removeAttribute("disabled")}else this.btnLoadMore.removeAttribute("disabled")}}customElements.define("dynamic-load-more",e)}if(!customElements.get("dynamic-load-previous")){class e extends DynamicLoad{constructor(){super(),this.btnLoadPrevious=this.querySelector(".js-btn-load-previous"),this.setProperties(),this.checkPageParameter(),window.addEventListener("shopify:section:load",(()=>{this.setProperties(),this.checkPageParameter()})),this.updateItemCount(),this.btnLoadPrevious.addEventListener("click",(e=>{e.preventDefault(),this.loadPreviousItems()}))}checkPageParameter(){const e=new URL(window.location.href),t=new URLSearchParams(e.search),r=parseInt(t.get("page"),10)||1;this.btnLoadPrevious.style.display=r<=1?"none":""}async loadPreviousItems(){this.btnLoadPrevious.setAttribute("disabled","true");const e=this.btnLoadPrevious.dataset.href;if(e)try{const t=await fetch(e),r=await t.text(),i=(new DOMParser).parseFromString(r,"text/html");let o;"product"===this.gridType?o=i.querySelector("#ProductGridContainer"):"collection"===this.gridType?o=i.querySelector("#CollectionGridContainer"):"article"===this.gridType&&(o=i.querySelector("#ArticleGridContainer"));const s=o?o.querySelector(`#${this.gridType}-grid`):null;if(s?this.appendContent(s.innerHTML,!0):console.warn(`New grid element (#${this.gridType}-grid) not found in fetched page.`),this.btnLoadPrevious=this.querySelector(".js-btn-load-previous"),!this.btnLoadPrevious)return void console.error("Load Previous button disappeared after content prepend. Cannot continue.");const n=i.querySelector(".js-btn-load-previous");if(n){const e=n.dataset.href;this.btnLoadPrevious.dataset.href=e}else this.btnLoadPrevious.dataset.href="";const a=new URL(window.location.href),d=new URLSearchParams(a.search),c=parseInt(d.get("page"),10)||1;this.updateUrl(c-1),this.checkPageParameter(),this.updateItemCount()}catch(e){console.error("Load previous error:",e);const t=document.createElement("div");t.className="error-message p-4 bg-red-100 border border-red-400 text-red-700 rounded-md mt-4",t.textContent=`An error occurred: ${e.message}`,this.btnLoadPrevious.after(t),setTimeout((()=>t.remove()),5e3)}finally{this.btnLoadPrevious.removeAttribute("disabled")}else this.btnLoadPrevious.removeAttribute("disabled")}}customElements.define("dynamic-load-previous",e)}