class ProductModal extends ModalDialog{constructor(){super(),this.sliderInstance=new Swiper(this.querySelector("[data-modal-slider]"),{slidesPerView:1,navigation:{prevEl:this.querySelector(".swiper-button--prev"),nextEl:this.querySelector(".swiper-button--next")},on:{slideChangeTransitionEnd:e=>{this.playActiveSlideVideo(e)}}})}show(e){this.openedBy=e,this.setAttribute("open",""),trapFocus(this,this.dialogHolder),window.pauseAllMedia(),e.hasAttribute("data-model-opener")?this.showActiveMedia(e.dataset.mediaId):this.showActiveMedia()}hide(){document.body.dispatchEvent(new CustomEvent("modalClosed")),this.removeAttribute("open"),removeTrapFocus(this.openedBy),window.pauseAllMedia()}connectedCallback(){const e=this.querySelector("[data-modal-slider]"),t=t=>{const i=!this.contains(t.target),d=e.contains(t.target);(!this.openedBy||i&&!d)&&this.hide()};document.addEventListener("click",t),document.body.addEventListener("modalClosed",(()=>{document.removeEventListener("click",t)}))}showActiveMedia(e="videos"){if("videos"!==e){const e=this.openedBy.getAttribute("data-media-id"),t=this.querySelector(`[data-media-id="${e}"]`);return t?.loadContent(),t.parentElement.classList.add("swiper-slide"),t.parentElement.classList.remove("hidden"),this.querySelectorAll("[data-media-id]").forEach((e=>{e!==t&&(e.parentElement.classList.remove("swiper-slide"),e.parentElement.classList.add("hidden"))})),void this.sliderInstance.update()}this.querySelectorAll("[data-media-id]").forEach((e=>{if("product-model"===e.tagName.toLowerCase())return e.parentElement.classList.remove("swiper-slide"),void e.parentElement.classList.add("hidden");e.parentElement.classList.add("swiper-slide"),e.parentElement.classList.remove("hidden")})),this.querySelector("[data-media-id]:not(.hidden [data-media-id])").loadContent()}hide(){super.hide(),pauseAllMedia();const e=this.querySelector(".swiper-slide-active product-model");e&&(e.removeAttribute("loaded"),e.querySelector(".shopify-model-viewer-ui")?.remove())}playActiveSlideVideo(e){pauseAllMedia();e.slides.filter((e=>e.classList.contains("swiper-slide-active")))[0].querySelector("deferred-media").loadContent()}}customElements.define("product-modal",ProductModal)